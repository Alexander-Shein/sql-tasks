Create a SQL query to display the name of each customer along with their most expensive purchased product:

| CompanyName | ProductName | PricePerItem |
___________________

I now that it's bad sql but at the moment a haven't another decision

SELECT DISTINCT [cst].[CompanyName], [prt].[ProductName], ([odsDet].[UnitPrice] * [odsDet].[Quantity]) - ([odsDet].[UnitPrice] * [odsDet].[Quantity] * [odsDet].[Discount]) AS [UnitPrice]
FROM [Northwind].[dbo].[Customers] [cst]
JOIN [Northwind].[dbo].[Orders] [ods]
ON [cst].[CustomerID] = [ods].[CustomerID]
JOIN [Northwind].[dbo].[Order Details] [odsDet]
ON [odsDet].[OrderID] = [ods].[OrderID]
JOIN [Northwind].[dbo].[Products] [prt]
ON [prt].[ProductID] = [odsDet].[ProductID]
WHERE EXISTS(
	SELECT ''
	FROM [Northwind].[dbo].[Customers] [cstt]
	JOIN [Northwind].[dbo].[Orders] [odss]
	ON [cstt].[CustomerID] = [odss].[CustomerID]
	JOIN [Northwind].[dbo].[Order Details] [odsDett]
	ON [odsDett].[OrderID] = [odss].[OrderID]
	JOIN [Northwind].[dbo].[Products] [prtt]
	ON [prtt].[ProductID] = [odsDett].[ProductID]
	GROUP BY [cstt].[CompanyName]
	HAVING [cst].[CompanyName] = [cstt].[CompanyName] AND MAX(([odsDett].[UnitPrice] * [odsDett].[Quantity]) - ([odsDett].[UnitPrice] * [odsDett].[Quantity] * [odsDett].[Discount])) = (([odsDet].[UnitPrice] * [odsDet].[Quantity]) - ([odsDet].[UnitPrice] * [odsDet].[Quantity] * [odsDet].[Discount]))
)
ORDER BY [cst].[CompanyName]
