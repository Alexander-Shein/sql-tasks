-- NON-REPEATABLE READ(3)

DROP TABLE IF EXISTS TranIsolLevels;
CREATE TABLE TranIsolLevels (
Id INTEGER PRIMARY KEY NOT NULL,
TestValue INTEGER NOT NULL
);

INSERT INTO TranIsolLevels VALUES(1,1);

SET TRANSACTION ISOLATION LEVEL REPEATABLE READ;
START TRANSACTION;
SELECT  Id,TestValue
FROM TranIsolLevels;
SELECT pg_sleep(7);
SELECT  Id,TestValue
FROM TranIsolLevels;
COMMIT;


BEGIN;
UPDATE TranIsolLevels
SET TestValue=TestValue+7
WHERE Id=1;
SELECT Testvalue
FROM TranIsolLevels
WHERE Id=1;
COMMIT;
