в) Создать хранимую процедуру которая принимает в себя информацию о Order и массив Order Details и создает новый Order в системе. (CreateOrder)

DROP TYPE OrderDetailsType
CREATE TYPE [OrderDetailsType] AS TABLE
(
  ProductId INT NOT NULL,
  UnitPrice MONEY NOT NULL,
  Quantity SMALLINT NOT NULL,
  Discount REAL NOT NULL
);

DROP PROCEDURE CreateOrder;
CREATE PROCEDURE CreateOrder
@CustomerId NCHAR(5),
@EmployeeId INT,
@OrderDate DATE,
@RequiredDate DATE,
@ShippedDate DATE,
@ShipVia INT,
@Freight MONEY,
@ShipName NVARCHAR(40),
@ShipAddress NVARCHAR(60),
@ShipCity NVARCHAR(15),
@ShipRegion NVARCHAR(15),
@ShipPostalCode NVARCHAR(10),
@ShipCountry NVARCHAR(15),
@OrderDetailsData AS OrderDetailsType READONLY
AS
BEGIN
INSERT INTO Orders(CustomerId, EmployeeId, OrderDate,RequiredDate,ShippedDate, ShipVia, Freight, ShipName, ShipAddress, ShipCity, ShipRegion, ShipPostalCode, ShipCountry)
VALUES(@CustomerId, @EmployeeId,@OrderDate,@RequiredDate,@ShippedDate, @ShipVia, @Freight, @ShipName, @ShipAddress, @ShipCity, @ShipRegion, @ShipPostalCode, @ShipCountry)
INSERT INTO [Order Details](OrderId, ProductID, UnitPrice, Quantity, Discount)
SELECT @@IDENTITY, [ProductID],[UnitPrice],[Quantity],[Discount]
FROM @OrderDetailsData
END

DECLARE @dt DATETIME
SET @dt=GETDATE()
DECLARE @OrderDetailsData OrderDetailsType
INSERT  @OrderDetailsData (ProductId, UnitPrice, Quantity, Discount)
VALUES (45, 544, 3, 0)
EXEC CreateOrder 'VINET', 8,@dt,@dt,@dt, 3, 45, 'name','adress', 'city', 'region', 'postalCode', 'Country', @OrderDetailsData
