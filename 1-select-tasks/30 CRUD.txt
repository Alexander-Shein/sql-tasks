a)

CREATE
	PROCEDURE dbo.GetOrderById @OrderID INT AS BEGIN TRY SELECT
		OrderID,
		CustomerID,
		EmployeeID,
		OrderDate,
		RequiredDate,
		ShippedDate,
		ShipVia,
		Freight,
		ShipName,
		ShipAddress,
		ShipCity,
		ShipRegion,
		ShipPostalCode,
		ShipCountry
	FROM
		dbo.Orders
	WHERE
		OrderID = @OrderID SELECT
			OrderID,
			ProductID,
			UnitPrice,
			Quantity,
			Discount
		FROM
			dbo.[Order Details]
		WHERE
			OrderID = @OrderID;
END TRY BEGIN CATCH ROLLBACK;
END CATCH

б)

CREATE
	PROCEDURE dbo.DeleteOrderById @OrderID INT 
	AS BEGIN TRY 
	DELETE
		FROM
			dbo.[Order Details]
		WHERE
			OrderID = @OrderID DELETE
			FROM
				dbo.Orders
			WHERE
				OrderID = @OrderID;

BEGIN CATCH ROLLBACK;
END CATCH

в) 
CREATE
	TYPE dbo.OrderDetailsList AS TABLE
		(
			ProductID INT,
			UnitPrice MONEY,
			Quantity SMALLINT,
			Discount REAL
		);


CREATE
	PROCEDURE dbo.CreateOrder
	@OrderDetailsList AS dbo.OrderDetailsList READONLY,
	@OrderID INT,
	@CustomerID NCHAR(5),
	@EmployeeID INT,
	@OrderDate DATETIME,
	@RequiredDate DATETIME,
	@ShippedDate DATETIME,
	@ShipVia INT,
	@Freight MONEY,
	@ShipName NVARCHAR(40),
	@ShipAddress NVARCHAR(60),
	@ShipCity NVARCHAR(15),
	@ShipRegion NVARCHAR(15),
	@ShipPostalCode NVARCHAR(10),
	@ShipCountry NVARCHAR(15)
	AS 
	BEGIN TRY
	BEGIN TRANSACTION
		INSERT INTO
			dbo.Orders(
				CustomerID,
				EmployeeID,
				OrderDate,
				RequiredDate,
				ShippedDate,
				ShipVia,
				Freight,
				ShipName,
				ShipAddress,
				ShipCity,
				ShipRegion,
				ShipPostalCode,
				ShipCountry
			)
			VALUES (
				@CustomerID,
				@EmployeeID,
				@OrderDate,
				@RequiredDate,
				@ShippedDate,
				@ShipVia,
				@Freight,
				@ShipName,
				@ShipAddress,
				@ShipCity,
				@ShipRegion,
				@ShipPostalCode,
				@ShipCountry
			);
		INSERT
			dbo.[Order Details](
				ProductID,
				UnitPrice,
				Quantity,
				Discount
			)
		SELECT @@IDENTITY
				ProductID,
				UnitPrice,
				Quantity,
				Discount
		FROM @OrderDetailsList;
		
		COMMIT;		
	END TRY
	BEGIN CATCH
	ROLLBACK;
	END CATCH
	
-- Run

DECLARE @OrderDetailsL AS dbo.OrderDetailsList
INSERT @OrderDetailsL (ProductID, UnitPrice, Quantity, Discount)
VALUES (42, 30, 12, 0.15)
DECLARE @dt DATETIME
SET @dt=GETDATE()
EXEC dbo.CreateOrder @OrderDetailsL, 102554, 'SIOUE', 2, @dt, @dt, @dt, 5, 46, 'Fologr', 'Wolski Zajazd', 'ul. Filtrowa 68', 'Warszawa', NULL, '01-012', 'Poland';

г) 

CREATE
	TYPE dbo.OrderDetailsList AS TABLE
		(
			ProductID INT,
			UnitPrice MONEY,
			Quantity SMALLINT,
			Discount REAL
		);
		
CREATE
	PROCEDURE dbo.UpdateOrder
	@OrderDetailsList AS dbo.OrderDetailsList READONLY,
	@OrderID INT,
	@CustomerID NCHAR(5),
	@EmployeeID INT,
	@OrderDate DATETIME,
	@RequiredDate DATETIME,
	@ShippedDate DATETIME,
	@ShipVia INT,
	@Freight MONEY,
	@ShipName NVARCHAR(40),
	@ShipAddress NVARCHAR(60),
	@ShipCity NVARCHAR(15),
	@ShipRegion NVARCHAR(15),
	@ShipPostalCode NVARCHAR(10),
	@ShipCountry NVARCHAR(15)
	AS 
	BEGIN TRY
	BEGIN TRANSACTION
		UPDATE
			dbo.Orders
			SET
				CustomerID = @CustomerID,
				EmployeeID = @EmployeeID,
				OrderDate = @OrderDate,
				RequiredDate = @RequiredDate,
				ShippedDate = @ShippedDate,
				ShipVia = @ShipVia,
				Freight = @Freight,
				ShipName = @ShipName,
				ShipAddress = @ShipAddress,
				ShipCity = @ShipCity,
				ShipRegion = @ShipRegion,
				ShipPostalCode = @ShipPostalCode,
				ShipCountry = @ShipCountry
				WHERE OrderID = @OrderID
		INSERT
			dbo.[Order Details](
				ProductID,
				UnitPrice,
				Quantity,
				Discount
			)
		SELECT @@IDENTITY
				ProductID,
				UnitPrice,
				Quantity,
				Discount
		FROM @OrderDetailsList;
		COMMIT;		
	END TRY
	BEGIN CATCH
	ROLLBACK;
	END CATCH

-- Run
	
DECLARE @OrderDetailsL AS dbo.OrderDetailsList
INSERT @OrderDetailsL (ProductID, UnitPrice, Quantity, Discount)
VALUES (42, 30, 12, 0.15)
DECLARE @dt DATETIME
SET @dt=GETDATE()
EXEC dbo.UpdateOrder @OrderDetailsL, 102554, 'SIODE', 2, @dt, @dt, @dt, 5, 46, 'Fologr', 'Wolski Zajazd', 'ul. Filtrowa 68', 'Warszawa', NULL, '01-012', 'Poland';








